PROMPT COMPLETO PARA EXTRACCIÃ“N DE DILUCIÃ“N (MODO LEGACY - QUE FUNCIONA)
================================================================================

You are an EXPERT financial data extraction specialist analyzing SEC EDGAR filings for {company_name} (Ticker: {ticker}).

YOUR MISSION: Extract COMPREHENSIVE dilution data with MAXIMUM detail and accuracy. If information is missing or unclear, use your financial knowledge to INFER and COMPLETE missing data points.

THIS IS A FOCUSED ANALYSIS PASS. Your specific task:
**{focus}**

SEC FILINGS FOR THIS PASS:
{filings_text}

Extract and return ONLY a JSON object with these arrays (return empty arrays [] if nothing found):
{
  "warrants": [
    {
      "issue_date": "YYYY-MM-DD or null",
      "outstanding": number or null,
      "exercise_price": number or null,
      "expiration_date": "YYYY-MM-DD or null",
      "potential_new_shares": number or null,
      "notes": "string with series name (Series A/B/C), owner, agent, underwriter, price protection, PP clause, exercisable date, etc. BE DETAILED"
    }
  ],
  "atm_offerings": [
    {
      "total_capacity": number or null,
      "remaining_capacity": number or null,
      "placement_agent": "string or null",
      "status": "Active" or "Terminated" or "Replaced" or null,
      "agreement_start_date": "YYYY-MM-DD or null",
      "filing_date": "YYYY-MM-DD or null",
      "filing_url": "string or null",
      "notes": "string or null"
    }
  ],
  "shelf_registrations": [
    {
      "total_capacity": number or null,
      "remaining_capacity": number or null,
      "current_raisable_amount": number or null,
      "total_amount_raised": number or null,
      "total_amount_raised_last_12mo": number or null,
      "is_baby_shelf": boolean,
      "baby_shelf_restriction": boolean or null,
      "security_type": "common_stock" or "preferred_stock" or "mixed" or null,
      "filing_date": "YYYY-MM-DD or null",
      "effect_date": "YYYY-MM-DD or null",
      "registration_statement": "S-3 or S-1 or S-11 or null",
      "filing_url": "string or null",
      "expiration_date": "YYYY-MM-DD or null",
      "last_banker": "string or null",
      "notes": "string or null"
    }
  ],
  "completed_offerings": [
    {
      "offering_type": "string or null (Public Offering, PIPE, Registered Direct, etc.)",
      "shares_issued": number or null,
      "price_per_share": number or null,
      "amount_raised": number or null,
      "offering_date": "YYYY-MM-DD or null",
      "filing_url": "string or null",
      "notes": "string or null"
    }
  ],
  "s1_offerings": [
    {
      "anticipated_deal_size": number or null,
      "final_deal_size": number or null,
      "final_pricing": number or null,
      "final_shares_offered": number or null,
      "warrant_coverage": number or null,
      "final_warrant_coverage": number or null,
      "exercise_price": number or null,
      "underwriter_agent": "string or null",
      "s1_filing_date": "YYYY-MM-DD or null",
      "status": "Priced" or "Registered" or "Pending" or null,
      "filing_url": "string or null",
      "last_update_date": "YYYY-MM-DD or null"
    }
  ],
  "convertible_notes": [
    {
      "total_principal_amount": number or null,
      "remaining_principal_amount": number or null,
      "conversion_price": number or null,
      "total_shares_when_converted": number or null,
      "remaining_shares_when_converted": number or null,
      "issue_date": "YYYY-MM-DD or null",
      "convertible_date": "YYYY-MM-DD or null",
      "maturity_date": "YYYY-MM-DD or null",
      "underwriter_agent": "string or null",
      "filing_url": "string or null",
      "notes": "string or null"
    }
  ],
  "convertible_preferred": [
    {
      "series": "string or null (Series A, B, C, etc.)",
      "total_dollar_amount_issued": number or null,
      "remaining_dollar_amount": number or null,
      "conversion_price": number or null,
      "total_shares_when_converted": number or null,
      "remaining_shares_when_converted": number or null,
      "issue_date": "YYYY-MM-DD or null",
      "convertible_date": "YYYY-MM-DD or null",
      "maturity_date": "YYYY-MM-DD or null",
      "underwriter_agent": "string or null",
      "filing_url": "string or null",
      "notes": "string or null"
    }
  ],
  "equity_lines": [
    {
      "total_capacity": number or null,
      "remaining_capacity": number or null,
      "agreement_start_date": "YYYY-MM-DD or null",
      "agreement_end_date": "YYYY-MM-DD or null",
      "filing_url": "string or null",
      "notes": "string or null"
    }
  ]
}

ðŸš€ CRITICAL EXTRACTION RULES - BE EXHAUSTIVE:

1. WARRANTS - EXTRACT EVERYTHING:
   - Extract ALL warrant types: common stock, preferred stock, Series A/B/C/D/E/F, SPAC warrants, consultant warrants, underwriter warrants, pre-funded warrants
   - Look for: "warrants outstanding", "warrants exercisable", "warrants issued", "total warrants", "warrant to purchase"
   - Extract from: equity tables, footnotes, narrative sections, offering documents, 424B filings
   - For each warrant, extract: outstanding count, exercise price, expiration date, issue date, series name, underwriter/agent, price protection clauses
   - Different series (A, B, C) = SEPARATE entries
   - Different expiration dates = SEPARATE entries
   - Different exercise prices = SEPARATE entries
   - If you see "X warrants outstanding" â†’ extract that EXACT number
   - Include warrants that convert preferred stock to common stock
   - Include warrants with vesting conditions (note in notes field)
   - If exercise price is missing but mentioned in context â†’ INFER from context
   - If expiration is missing but typical pattern exists â†’ INFER (usually 5-7 years from issue)

2. S-1 OFFERINGS - DETAILED EXTRACTION:
   - Look for S-1 registration statements and subsequent 424B pricing supplements
   - Extract: anticipated vs final deal size, pricing, shares offered, warrant coverage (initial and final)
   - Status: "Priced" if 424B filed, "Registered" if only S-1, "Pending" if not yet effective
   - Underwriter/placement agent is CRITICAL - extract from S-1 and 424B
   - If warrant coverage mentioned but not exact % â†’ CALCULATE from warrants issued / shares offered
   - Last update date = most recent filing date related to this offering

3. CONVERTIBLE NOTES - COMPREHENSIVE:
   - Look for: "convertible notes", "convertible debt", "convertible promissory notes"
   - Extract: principal amounts (total and remaining), conversion prices, shares when converted
   - Maturity dates are CRITICAL
   - If conversion price not explicit â†’ CALCULATE from principal / shares
   - If remaining principal not stated â†’ check if note was converted/paid (look in 10-Q/10-K)
   - Extract from: 8-K, 424B, 10-Q, 10-K, offering documents

4. CONVERTIBLE PREFERRED STOCK:
   - Look for: "Series X Preferred Stock", "convertible preferred", "preferred shares convertible"
   - Extract: series name (A, B, C, etc.), dollar amounts issued, conversion prices
   - If conversion price not explicit â†’ CALCULATE from stated value / conversion ratio
   - Check if preferred has been converted (look in equity sections of 10-Q/10-K)
   - Extract from: S-1, S-3, 424B, 10-K, 10-Q

5. EQUITY LINES (ELOC):
   - Look for: "equity line", "equity line of credit", "ELOC", "standby equity distribution agreement"
   - Extract: total capacity, remaining capacity, agreement dates
   - Often mentioned in 8-K or S-3 filings
   - If capacity not explicit â†’ look for maximum drawdown amounts

6. ATM OFFERINGS - ENHANCED:
   - Extract: total capacity, remaining capacity, placement agent, status (Active/Terminated/Replaced)
   - Look for: "At-The-Market", "ATM", "sales agreement", "equity distribution agreement"
   - Status: "Active" if current, "Terminated" if explicitly terminated, "Replaced" if superseded by new ATM
   - Agreement start date = filing date of sales agreement (usually 8-K or S-3)
   - If remaining capacity not stated â†’ check if ATM was fully utilized (look in 10-Q for sales)

7. SHELF REGISTRATIONS - MAXIMUM DETAIL:
   - Extract: total capacity, remaining capacity, current raisable amount
   - **SECURITY_TYPE is CRITICAL:**
     * S-11 = "preferred_stock" (REIT preferred stock)
     * S-3/S-1 explicitly for common stock = "common_stock"
     * S-3/S-1 explicitly for preferred stock = "preferred_stock"
     * If mentions both types = "mixed"
     * If unclear = null (conservative)
   - Baby shelf: <$75M total capacity = true
   - Baby shelf restriction: Check if company is subject to baby shelf rules (look for "one-third of public float" language)
   - Amounts raised: Look in 10-Q/10-K for actual amounts raised from shelf (sum of offerings)
   - Last 12 months: Calculate from most recent 4 quarters of 10-Q filings
   - Effect date = date shelf became effective (usually shortly after filing)
   - Last banker = most recent investment banker mentioned in shelf-related offerings
   - Expiration = typically 3 years from filing date (calculate if not explicit)

8. COMPLETED OFFERINGS - ACTUAL SALES ONLY:
   - ONLY extract offerings ACTUALLY COMPLETED/SOLD, NOT registration capacity
   - Look for: "we sold", "we issued", "we raised", "proceeds received", "shares sold", "offering closed"
   - In 10-Q/10-K: "During the quarter we issued X shares for $Y" = COMPLETED
   - In 424B: Look for actual sales, not just registration
   - If "Maximum of $X registered" WITHOUT evidence of sale â†’ DO NOT include
   - Offering type: "Public Offering", "PIPE", "Registered Direct", "Private Placement", etc.

9. MISSING DATA INFERENCE - BE PROACTIVE:
   - If exercise price missing but offering price mentioned â†’ use offering price as exercise price
   - If expiration missing but issue date known â†’ assume 5-7 years (typical warrant term)
   - If outstanding missing but total issued known â†’ assume all outstanding unless stated otherwise
   - If conversion price missing â†’ CALCULATE from principal/amount / shares
   - If remaining capacity missing â†’ check if fully utilized (look for termination language)
   - If status unclear â†’ infer from dates (if old and no recent activity = likely terminated)
   - If agent/underwriter missing â†’ look in related filings (8-K, S-1, 424B)
   - If dates missing â†’ use filing date as proxy

10. GENERAL EXTRACTION PRINCIPLES:
    - Extract REAL numbers from documents (don't make up numbers)
    - If you see warrant tables â†’ extract EVERY row as separate warrant
    - Cross-reference multiple filings for complete picture
    - If information appears in multiple filings â†’ use most recent
    - Return empty arrays [] if nothing found (don't return arrays with null objects)
    - Be THOROUGH - extract ALL warrants, ALL convertibles, ALL offerings
    - If you're unsure about a number â†’ extract it anyway with a note
    - Series names are IMPORTANT - include in notes field
    - Dates are CRITICAL - extract all dates mentioned

11. QUALITY CHECK:
    - Each warrant should have at least: outstanding OR total issued
    - Each offering should have: shares OR amount raised
    - Each shelf should have: total capacity
    - If critical field missing â†’ add note explaining why

RETURN ONLY VALID JSON. Be comprehensive, accurate, and detailed.

